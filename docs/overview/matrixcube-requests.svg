<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="823px" preserveAspectRatio="none" style="width:1007px;height:823px;background:#FFFFFF;" version="1.1" viewBox="0 0 1007 823" width="1007px" zoomAndPan="magnify"><defs><filter height="300%" id="f1h3m3bjhg3hnu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="811.9141" style="stroke:#A80036;stroke-width:1.0;" width="450.5" x="146.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="347.75" y="18.0669">Store1</text><rect fill="#DDDDDD" height="811.9141" style="stroke:#A80036;stroke-width:1.0;" width="180" x="619" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="685" y="18.0669">Store2</text><rect fill="#DDDDDD" height="811.9141" style="stroke:#A80036;stroke-width:1.0;" width="180" x="821" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="887" y="18.0669">Store3</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="30" x2="30" y1="60.4297" y2="779.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="199.5" x2="199.5" y1="60.4297" y2="779.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="359" x2="359" y1="60.4297" y2="779.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="507" x2="507" y1="60.4297" y2="779.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="709" x2="709" y1="60.4297" y2="779.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="911" x2="911" y1="60.4297" y2="779.6172"/><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="12" y="45.1279">User</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="5" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="12" y="798.6123">User</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="95" x="150.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="157.5" y="45.1279">Shard Proxy</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="95" x="150.5" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="157.5" y="798.6123">Shard Proxy</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="307" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="314" y="45.1279">Local Router</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="307" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="314" y="798.6123">Local Router</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="421" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="428" y="45.1279">Shard1 Leader Replica</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="421" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="428" y="798.6123">Shard1 Leader Replica</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="623" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="630" y="45.1279">Shard2 Leader Replica</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="623" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="630" y="798.6123">Shard2 Leader Replica</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="825" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="832" y="45.1279">Shard3 Leader Replica</text><rect fill="#FEFECE" filter="url(#f1h3m3bjhg3hnu)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="168" x="825" y="778.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="832" y="798.6123">Shard3 Leader Replica</text><polygon fill="#A80036" points="188,87.5625,198,91.5625,188,95.5625,192,91.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="30" x2="194" y1="91.5625" y2="91.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="37" y="86.4966">send request on key1</text><polygon fill="#A80036" points="347,116.6953,357,120.6953,347,124.6953,351,120.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="120.6953" y2="120.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="207" y="115.6294">find shard of key1</text><polygon fill="#A80036" points="211,145.8281,201,149.8281,211,153.8281,207,149.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="149.8281" y2="149.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="217" y="144.7622">shard1</text><polygon fill="#A80036" points="347,174.9609,357,178.9609,347,182.9609,351,178.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="178.9609" y2="178.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="207" y="173.895">find Leader of shard1</text><polygon fill="#A80036" points="211,204.0938,201,208.0938,211,212.0938,207,208.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="208.0938" y2="208.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="217" y="203.0278">store1</text><polygon fill="#A80036" points="495,233.2266,505,237.2266,495,241.2266,499,237.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="501" y1="237.2266" y2="237.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="207" y="232.1606">send request</text><polygon fill="#A80036" points="211,262.3594,201,266.3594,211,270.3594,207,266.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="205" x2="506" y1="266.3594" y2="266.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="217" y="261.2935">return response</text><polygon fill="#A80036" points="41,291.4922,31,295.4922,41,299.4922,37,295.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="199" y1="295.4922" y2="295.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="47" y="290.4263">return response</text><polygon fill="#A80036" points="188,320.625,198,324.625,188,328.625,192,324.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="30" x2="194" y1="324.625" y2="324.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="37" y="319.5591">send request on key10</text><polygon fill="#A80036" points="347,349.7578,357,353.7578,347,357.7578,351,353.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="353.7578" y2="353.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="207" y="348.6919">find shard of key10</text><polygon fill="#A80036" points="211,378.8906,201,382.8906,211,386.8906,207,382.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="382.8906" y2="382.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="217" y="377.8247">shard2</text><polygon fill="#A80036" points="347,408.0234,357,412.0234,347,416.0234,351,412.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="412.0234" y2="412.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="207" y="406.9575">find Leader of shard2</text><polygon fill="#A80036" points="211,437.1563,201,441.1563,211,445.1563,207,441.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="441.1563" y2="441.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="217" y="436.0903">store2</text><polygon fill="#A80036" points="697,466.2891,707,470.2891,697,474.2891,701,470.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="703" y1="470.2891" y2="470.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="207" y="465.2231">send request</text><polygon fill="#A80036" points="211,495.4219,201,499.4219,211,503.4219,207,499.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="205" x2="708" y1="499.4219" y2="499.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="217" y="494.356">return response</text><polygon fill="#A80036" points="41,524.5547,31,528.5547,41,532.5547,37,528.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="199" y1="528.5547" y2="528.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="47" y="523.4888">return response</text><polygon fill="#A80036" points="188,553.6875,198,557.6875,188,561.6875,192,557.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="30" x2="194" y1="557.6875" y2="557.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="37" y="552.6216">send request on key20</text><polygon fill="#A80036" points="347,582.8203,357,586.8203,347,590.8203,351,586.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="586.8203" y2="586.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="207" y="581.7544">find shard of key20</text><polygon fill="#A80036" points="211,611.9531,201,615.9531,211,619.9531,207,615.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="615.9531" y2="615.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="217" y="610.8872">shard3</text><polygon fill="#A80036" points="347,641.0859,357,645.0859,347,649.0859,351,645.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="353" y1="645.0859" y2="645.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="207" y="640.02">find Leader of shard3</text><polygon fill="#A80036" points="211,670.2188,201,674.2188,211,678.2188,207,674.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="358" y1="674.2188" y2="674.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="217" y="669.1528">store3</text><polygon fill="#A80036" points="899,699.3516,909,703.3516,899,707.3516,903,703.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="200" x2="905" y1="703.3516" y2="703.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="207" y="698.2856">send request</text><polygon fill="#A80036" points="211,728.4844,201,732.4844,211,736.4844,207,732.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="205" x2="910" y1="732.4844" y2="732.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="217" y="727.4185">return response</text><polygon fill="#A80036" points="41,757.6172,31,761.6172,41,765.6172,37,761.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="199" y1="761.6172" y2="761.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="47" y="756.5513">return response</text><!--MD5=[636b8a864d61055b2afe714c46c191f1]
@startuml

skinparam BoxPadding 10

participant User

box "Store1"
    participant "Shard Proxy" as proxy1
    participant "Local Router" as route1
    participant "Shard1 Leader Replica" as s1
end box

box "Store2"
    participant "Shard2 Leader Replica" as s2
end box

box "Store3"
    participant "Shard3 Leader Replica" as s3
end box

User  -> proxy1  : send request on key1
proxy1 -> route1 : find shard of key1 
route1 -> proxy1 : shard1
proxy1 -> route1 : find Leader of shard1
route1 -> proxy1 : store1
proxy1 -> s1 : send request
s1 - -> proxy1 : return response
proxy1 -> User  : return response

User  -> proxy1  : send request on key10
proxy1 -> route1 : find shard of key10 
route1 -> proxy1 : shard2
proxy1 -> route1 : find Leader of shard2
route1 -> proxy1 : store2
proxy1 -> s2 : send request
s2 - -> proxy1 : return response
proxy1 -> User  : return response

User  -> proxy1  : send request on key20
proxy1 -> route1 : find shard of key20 
route1 -> proxy1 : shard3
proxy1 -> route1 : find Leader of shard3
route1 -> proxy1 : store3
proxy1 -> s3 : send request
s3 - -> proxy1 : return response
proxy1 -> User  : return response
@enduml

PlantUML version 1.2021.16(Thu Dec 09 01:25:22 CST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>